{% extends 'archivos/base.html' %} {% block content %} {% load static %}

<div>
  {% for ramo in ramos %}
  <a href="/archivos/{{ramo.sigla}}">{{ramo.sigla}}</a>
  {% endfor %}
</div>

<a id="download-all" href="">Descargar todo el ramo</a>

<form action="{% url 'archivos:arch-root' current %}" method="post">
  {%csrf_token%}
  <!-- <table id="myTable"> -->
  <table
    id="myTable"
    class="table table-striped table-bordered table-sm"
    cellspacing="0"
    width="90%"
  >
    <thead>
      <tr class="myTable">
        <th></th>
        <th>NOMBRE</th>
        <th>TIPO</th>
        <th>SUBIDO</th>
        <th>SEMESTRE</th>
        <th>LINK</th>
      </tr>
    </thead>
    <tbody>
      {% for file in files %}
      <tr>
        <td>
          <input
            type="checkbox"
            id="{{file.id}}"
            name="files"
            value="{{file.id}}"
          />
        </td>
        <td>{{file.nombre}}</td>
        <td>{{file.tipo}}</td>
        <td>{{file.subido}}</td>
        <td>{{file.semestre}}</td>
        <td>
          <a download href="/media/{{file.archivo}}">download</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <input type="submit" value="Crear .zip" />
</form>

<a href="{{zip}}">{{zip}}</a>

{% endblock %} {% block javascript %}

<script>
  $(document).ready(function () {
    $("#myTable").DataTable({
      paging: false,
      stateSave: true,
      info: false,
      language: {
        search: "Filtrar",
      },
    });
  });

  $("#download-all").click(function (e) {
    e.preventDefault();
    var url = "{% url 'archivos:zip-ramo' current %}";
    $.get(url, function (data) {
      window.location.href = "/" + data["link"];
    });
  });
</script>

{% endblock javascript %}
